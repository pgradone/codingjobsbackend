# Create a Wordpress theme

## Why create a WP Theme ?

- Give a unique style to your website
- To perfectly control the code of his site
- Know how to create page templates to create specific layouts that do not offer standard themes
- Separation of concepts: presentation and content (the presentation is the theme that manages, the contents are in the database)
- Allows you to customize the look and feel of your website
- It is fun
 
## Anatomy of a theme

 - themes are placed in the `wp-content/themes/` of your Wordpress installation folder (one folder for one theme)
    *  **mandatory** one file `style.css` to control the graphic aspect
    *  one `screenshot.png` to preview the rendering in the theme admin pannel **(1200x900px)**
    *  **mandatory** at least one template file (generaly more than one) `index.php` see [hierarchy of templates](https://wphierarchy.com)
    * one `functions.php` file (optional) that is as the plugin of the theme
    *  some images, javascript files... in case of need

See [this graphic](http://yoast.com/wordpress-theme-anatomy/) to have a visual representation.

### style.css

The style file, in addition to carrying your css informations, must include a comment of this type at the beginning of the file so that your files are recognized as a theme:

    /*
    Theme Name: Twenty Thirteen
    Theme URI: http://wordpress.org/themes/twentythirteen
    Author: the WordPress team
    Author URI: http://wordpress.org/
    Description: The 2013 theme for WordPress takes us back to the blog, featuring a full range of post formats, each displayed beautifully in their own unique way. Design details abound, starting with a vibrant color scheme and matching header images, beautiful typography and icons, and a flexible layout that looks great on any device, big or small.
    Version: 1.0
    License: GNU General Public License v2 or later
    License URI: http://www.gnu.org/licenses/gpl-2.0.html
    Tags: black, brown, orange, tan, white, yellow, light, one-column, two-columns, right-sidebar, flexible-width, custom-header, custom-menu, editor-style, featured-images, microformats, post-formats, rtl-language-support, sticky-post, translation-ready
    Text Domain: twentythirteen
    This theme, like WordPress, is licensed under the GPL.
    Use it to make something cool, have fun, and share what you've learned with others.
    */
   
This information can be found in the admin site on the theme page.

### functions.php

A theme can use a `functions.php` file (optional). This file works basically as a plugin. If present, it is used and loaded by Wordpress during the initialization phase of the display of a page (admin or front).
It is useful for:
  - adding file uploads : scripts or css (javascript, css,)[see wp_enqueue_scripts](https://codex.wordpress.org/Plugin_API/Action_Reference/wp_enqueue_scripts)
 - activate theme features like :
 - [widgets areas](https://codex.wordpress.org/Sidebars)
 - [menus](https://codex.wordpress.org/Navigation_Menus)
 - [custom image sizes](https://codex.wordpress.org/Post_Thumbnails)
 - [post formats](https://codex.wordpress.org/Post_Formats)
 - [customized headers](https://codex.wordpress.org/Custom_Headers)
 - [customized backgrounds](https://codex.wordpress.org/Custom_Backgrounds)
 - Set options menus, and theme customization options
 - Define functions to use in your theme like for example redefining the length of the exerpt (summary) of an article,
 - Add customs posts, custom taxonomies, custom metas
 - Add pages and menus in the administration
 - ...

### template files

- Template files are source files written in php used to generate the pages requested on the site. They generate HTML files.
  - They consist of HTML code, PHP code with the [templates tags](https://codex.wordpress.org/Template_Tags) of Wordpress.

### Main theme files

**style.css**
The main style sheet of the theme, it must include the declaration of your theme in a comment block.

**rtl.css**
Optionally, this style sheet is used when the option to read right-to-left text is enabled in the administration. It can be generated by using the RTLer plugin.

**index.php**
The main template of your theme. If your theme is not a child theme, it is a mandatory file.

**comments.php**
AN included file to display the comments form and the list of available comments on a post or a page.

**front-page.php**
The front page specific template,used if your settings are defined to use a custom page as a homepage (not the posts list). 

**home.php**
The template used to display the home template for your post list (the default home page setting).


**single.php**
The template to display a single post content.

**single-{post-type}.php**
Used when you create custom post types to display the content of a specific post type detailled content, for example : if you define a new custom post type named 'book', Wordpress will try to use the `single-book.php` file to display the content of this post type.

**page.php**
The template used to display the content of a page.

**category.php**
The template used to display a posts list organized by categories.

**tag.php**
The template used to display a posts list organized by tags.

**taxonomy.php**
The template used to display a posts list organized by a custom taxonomy.

**author.php**
The template used to display a posts list filtered by authors.

**date.php**
The template used to display a posts list organized by date.

**archive.php**
The archive template is used when a category, author, or date is displayed. This template will be overwritten if the corresponding respective templates exist (category.php, author.php, date.php).

**search.php**
The template used to display a search result.

**attachment.php**
The template used to display an attachment (image, pdf...)

**image.php**
The template used to display an image attachment, if this template does not exist, Wordpress will try to use the default `attachment.php` template.

**404.php**
The template used to display a 404 error page.

...

### Basic Theme

 - style.css
 - index.php
 - functions.php
 - screenshot.png

### Custom Page Templates

You can create page templates with new files in the theme, they should simply include this comment at the beginning of the file:

    <?php
    /*
    Template Name: <Nom du template ici>
    */
    ?>

The new page template should appear in the admin dashboard under the **page template** window when editing a page.


### Request based templates

There is many ways to modify the way Wordpress displays your information in the templates :
 - Throuhg the [hierarchy of the templates](https://wphierarchy.com) : Wordpress loads templates based on the request made through the url (permalink). The URL indicates the type of data displayed, then Wordpress chosen through the template inheritance the file to display.
 - Through the use of **conditionals tags** inside your template

### Template tags

Wordpress template tags are divided into different parts:
 - **General tags**: `get_header(), get_footer(), get_sidebar(), get_template_part(), get_search_form(), wp_title(), single_cat_title()`...
 - **Author's tags** : `the_author(), get_the_author(), the_author_meta(), the_author_posts()`,...
 - **Category tags** : `the_category(), category_description(), single_cat_title()`...
 - **Comments tags** : `comment_author(), comment_date(), comment_form()`...
 - **Link tags** : `the_permalink(), get_permalink(), home_url(), site_url(), get_search_link(), get_edit_link(), get_attachment_link()`...
 - **Post tags** : next_post_link(), next_posts_link(), the_category(), the_content(), the_excerpt(), the_ID(), the_title(), the_date(), the_author()...
 - **Thumbnail tags** : `has_post_thumbnail(), get_post_thumbnail_id(), the_post_thumbnail(), get_the_post_thumbnail()`
 - **Navigation menu tags** : `wp_nav_menu()`
 - See the [complete tags list](https://codex.wordpress.org/Template_Tags)


### conditionals tags

A [conditional tag](https://codex.wordpress.org/Conditional_Tags) checks if a condition is `true` or `false` a gives you the possibility to modify the behavior of your code along the condition :

    <?php
    if ( is_category( '9' ) ) {
        get_template_part( 'single2' ); // looking for posts in category with ID of '9'
    } else {
        get_template_part( 'single1' ); // put this on every other category post
    }
    ?>

Here is a short list of them :

* Check if we are on the homepage `is_home()`
* Check if we are on an archive page `is_archive(), is_tag(), is_category(), is_date()`…
* Check if we are on an author's page `is_author()`
* Check if we are in the loop `in_the_loop()`
* Check if a plugin is acive `is_plugin_active()`
* Check if your theme supports one specific feature `current_theme_supports()`
* And a sample use of a conditional tag :

```
<?php if ( is_home() ) { ?>
    <p>You are on the homepage !</p>
<?php } ?>
```

We can of course use boths condition statements in one place:

```
<?php if ( is_home() && is_admin() ) {
    echo "<p>You are on the homepage as  an administrator.</p>";
}
?>
```

### includes

**includes** are some code portions of the templates :
 * header.php
 * footer.php
 * sidebar.php
 * searchform.php
 * loop.php
 * comments.php

They can be called by two functions :
- With a template tag : `get_header()`
- With the `get_template_part()` function


### File path in a theme

If in a stylesheet, the files are related to the style sheet and do not pose inclusion problems, it is otherwise for files related to a php template. For example, if you include images from an `images /` folder in your theme, you must specify the path to the theme to avoid broken links:

    <?php echo get_theme_file_uri( 'images/logo.png' ); ?>

    <img src="<?php echo get_template_directory_uri(); ?>/images/logo.png" width="" height="" alt="" />

    <!-- pour un thème enfant -->
    <img src="<?php echo get_stylesheet_directory_uri(); ?>/images/logo.png" width="" height="" alt="" />


### Global metadatas

Wordpress stores global information such as site title, description, encoding, language, template folder ... in a function called `bloginfo()` [see here](https://developer.wordpress.org/reference/functions/bloginfo/)

    <h1><?php bloginfo( 'name' ); ?></h1>

    <a href="<?php bloginfo('url'); ?>" title="<?php bloginfo('name'); ?>"><?php bloginfo('name'); ?></a>

### Theme Customization API

Since Wordpress 3.4, it is possible to use the theme customization feature provided by Wordpress. it basically works by adding support for a feature declared in the file `functions.php` via the function `add_theme_support()` [see here](https://developer.wordpress.org/reference/functions/add_theme_support/)

### Securing your data

 It is important to protect dynamic data to avoid hacks, for this reason dynamically generated texts must be passed into escape functions:

 - `esc_attr()`
 - `esc_html()`
 - `esc_url()`

See the [data validation page](https://codex.wordpress.org/Data_Validation#Attribute_Nodes)


### Theme classes

 - [body_class()](https://codex.wordpress.org/Function_Reference/body_class)
 - [post_class()](https://codex.wordpress.org/Function_Reference/post_class)
 - [comment_class()](https://codex.wordpress.org/Function_Reference/comment_class)

### header, footer and good practices

Wordpress needs some declaration in the header and the footer to work properly.

**header :**

    <!DOCTYPE html>
    <html <?php language_attributes(); ?>>
        <head>
            <meta charset="<?php bloginfo( 'charset' ); ?>" />
            <title><?php wp_title(); ?></title>
            <link rel="profile" href="http://gmpg.org/xfn/11" />
            <link rel="pingback" href="<?php bloginfo( 'pingback_url' ); ?>" />
            <?php if ( is_singular() && get_option( 'thread_comments' ) ) wp_enqueue_script( 'comment-reply' ); ?>
            <?php wp_head(); ?>
        </head>

**footer :**

    <?php wp_footer(); ?>
    </body>
    </html>

 - Use the correct DOCTYPE.
 - The `<html>` open tag must include the `language_attributes()` created by Wordpress
 - The `<meta>` charset must be included before any other text content, including the `<title>` tag.
 - Use `bloginfo()` to generate the description text in the meta description
 - User `wp_title()` to generate an Wordpress generated title text
 - Add RSS Links
 - Add a call for the `wp_head()` function just before the `</head>` ending tag. Wordpress and plugins use this function to inject there own scripts and styles
 - Do not include direct styles nor scripts directly in the header, prefers the  `wp_enqueue_scripts` and `wp_enqueue_style` in the `functions.php` file
 - Use the `wp_footer()` function in the footer.php include, just before the ending `</body>` tag. Wordpress use this function to inject it's own html and script code.
